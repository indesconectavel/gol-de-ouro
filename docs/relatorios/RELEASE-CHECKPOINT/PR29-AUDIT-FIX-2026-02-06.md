# Corre√ß√£o do check üß™ Testes Frontend (npm audit) ‚Äî PR #29

**Data:** 2026-02-06  
**Branch:** feat/payments-ui-pix-presets-top-copy  
**Objetivo:** Fazer o check "üß™ Testes Frontend" do workflow üé® Frontend Deploy (Vercel) passar, corrigindo vulnerabilidades em `goldeouro-player` com mudan√ßa m√≠nima e segura.

---

## HEAD antes e depois

| Momento | Commit (short) | Hash completo |
|---------|-----------------|----------------|
| **Antes (tag PRE)** | f2bb1b0 | f2bb1b05ca86173dccfe11054ab61e8d83524b5b |
| **Depois (fix)** | 0eb18af | 0eb18af4fb5fc811f68fd431cb54e1a022792dc9 |

---

## Tags

| Tag | Commit | Uso |
|-----|--------|-----|
| **PRE_AUDIT_FIX_2026-02-06_0213** | f2bb1b0 | Estado antes do fix; ponto de rollback. |
| **AUDIT_FIX_DONE_2026-02-06_0213** | 0eb18af | Commit do fix (audit 0 vuln, build OK). |

---

## Resumo do npm audit (goldeouro-player)

| Fase | Comando | Resultado |
|------|---------|-----------|
| **Antes** | `npm audit --audit-level=moderate` | 11 vulnerabilities (4 moderate, 7 high) ‚Äî exit 1 |
| **Ap√≥s `npm audit fix`** | idem | 4 vulnerabilities (2 moderate, 2 high) ‚Äî restantes exigiam breaking (vite 7, capacitor 8) |
| **Ap√≥s overrides + npm install** | idem | **0 vulnerabilities** ‚Äî exit 0 |

### Corre√ß√£o aplicada (m√≠nima, sem --force)

- **package.json:** adicionada se√ß√£o `overrides` para for√ßar vers√µes corrigidas de depend√™ncias transitivas:
  - `esbuild`: `^0.25.0` (corrige GHSA-67mh-4wv8-2f99; Vite continua em 5.x)
  - `tar`: `^7.5.7` (corrige vulnerabilidades em node-tar; @capacitor/cli continua em 7.x)
- **package-lock.json:** atualizado por `npm install` (e pelo `npm audit fix` anterior).
- Nenhum uso de `npm audit fix --force`; nenhuma altera√ß√£o em c√≥digo de neg√≥cio (GameShoot, gameService, etc.).

---

## Arquivos alterados

| Arquivo | Altera√ß√£o |
|---------|-----------|
| goldeouro-player/package.json | Inclus√£o de `"overrides": { "esbuild": "^0.25.0", "tar": "^7.5.7" }`. |
| goldeouro-player/package-lock.json | Atualiza√ß√£o de depend√™ncias e resolu√ß√£o com overrides (263 inser√ß√µes, 265 dele√ß√µes no diff). |

---

## Valida√ß√£o

- **npm -v:** 10.9.2  
- **node -v:** v22.17.0  
- **npm audit --audit-level=moderate:** exit 0, 0 vulnerabilities.  
- **npm run build:** conclu√≠do com sucesso (Vite 5.4.21, build em ~7.8s).  

---

## Confirma√ß√£o: sem mudan√ßas em c√≥digo de neg√≥cio

- Nenhum arquivo em `goldeouro-player/src` foi modificado (nem GameShoot.jsx, nem gameService.js, nem rotas, nem componentes de neg√≥cio).
- Apenas `goldeouro-player/package.json` e `goldeouro-player/package-lock.json` foram alterados.

---

## Rollback

### Op√ß√£o 1: Revert do commit do fix

```powershell
git checkout feat/payments-ui-pix-presets-top-copy
git pull origin feat/payments-ui-pix-presets-top-copy
git revert 0eb18af --no-edit
git push origin feat/payments-ui-pix-presets-top-copy
```

### Op√ß√£o 2: Reset local para o estado PRE (sem force push)

```powershell
git checkout feat/payments-ui-pix-presets-top-copy
git reset --hard PRE_AUDIT_FIX_2026-02-06_0213
# Reposit√≥rio local fica no estado anterior ao fix; n√£o fazer git push --force sem combinar com o time.
```

Para apenas descartar o fix no branch remoto ap√≥s um revert (Op√ß√£o 1), o push do revert √© suficiente; n√£o √© necess√°rio force push.

---

*Relat√≥rio gerado em 2026-02-06. Tags e commit dispon√≠veis no remoto.*
